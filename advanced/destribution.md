## 分布式算法
### raft协议
- 是分布式数据一致性算法
- 是leader-follower模式

2. Raft 工作流程分为Propose，Append，Broadcast 和 Apply。
    1. 客户发起交易，叫做 Propose
    2. 记录交易，这个叫做 Append
    3. 通知其他网点，这个叫做 Broadcast
    4. 等最后知道大部分网点都确认了这笔交易记录，就执行交易，也就是 Apply。

2. 
对于客户 A，操作是 Propose，Append，Broadcast， Apply，对于客户 B 也是一样的流程，之前我们必须等 A 完成了，才能处理 B。
3. 
Batch

如果很多客户同时要发起交易，那么我们可以将这些交易记录，用一个消息发送到其它网点，这样我们就不需要一个一个的发送消息了，这就是 Batch。

各个网点之间距离还是有点远的，消息传递的时间开销还是有点大的。使用 Batch 可以减少消息的发送次数，自然就能提高效率了。

## 分布式CAP理论
- C Consistency 可用性，即任一个节点任何时候都可以被访问。   
- A Availability 数据一致性，即不同节点间的数据是相同的。
- P Partition tolerance 分区容错性，即一个系统的不同的功能被部署在了不同的节点上。

- 分布式系统不能同时满足3个要求的根本原因：由于不同的功能设置在了不同的节点（服务器）上，存在网络延迟故障等。
- 假设存在nodeA 和 nodeB 两个节点，节点间相互同步数据保持数据的一致性。
    满足CA：发生网络故障时，节点间无法进行数据同步，但不影响，因为所有的功能都被部署在了同一个节点上。
    满足AP：发生网络故障时，节点间无法进行数据同步，则禁止被外部访问。
    满足CP：发生网络故障时，节点间无法进行数据同步，继续返回旧的数据先。

## 微服务
- 分而治之的思想。
- 一种架构风格，软件的开发模式。
- 行为：将集成所有功能的一个进程 按功能模块拆分为 多个进程。
- 优点：可扩展，功能内聚，解耦，敏捷开发。 
- 缺点：进程间的通信带来了其它的问题，网络可靠性，通信安全，网络时延。

## 算法
1. 一致性hash算法的目的  
相当于提供了一个虚拟的中间层，把虚拟的slot和真实的物理节点关联起来，当动态地添加和减少节点时，能够有效地减少数据的迁移量。